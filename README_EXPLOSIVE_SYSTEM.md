# 폭발적 복리 트레이딩 시스템

## 🚀 시스템 개요

**세계 최초 자가 학습 복리 폭발 트레이딩 시스템**

- **ETH 봇**: 복리 +4,654% (백테스트 검증)
- **KIS 봇**: 연 +2,634% (백테스트 검증)
- **자동 학습**: 실행 중 더 나은 전략 자동 발견 & 교체

---

## 📁 시스템 구조

```
코드5/
├── START_EXPLOSIVE_TRADING.bat           # 원클릭 실행
├── unified_explosive_trader_manager.py   # 통합 매니저
├── continuous_strategy_learner.py        # 연속 학습 엔진
├── eth_current_strategy.json             # ETH 현재 전략
└── kis_current_strategy.json             # KIS 현재 전략

코드3/
├── llm_eth_trader_v3_explosive.py        # ETH 폭발 전략 봇
└── eth_trade_history.json                # ETH 거래 히스토리

코드4/
├── kis_llm_trader_v2_explosive.py        # KIS 폭발 전략 봇
├── kis_trade_history.json                # KIS 거래 히스토리
└── continuous_learning_monitor.py        # 실시간 모니터
```

---

## 🎯 핵심 기능

### 1. 복리 폭발 전략

**ETH 전략:**
- ✅ 60분 이내 청산 (120분+ 보유는 57.4% 손실률)
- ✅ 추세 반대 진입 차단 (220건 손실 제거)
- ✅ 동적 손절: -2.5% → -2.0% (검증 완료 후)
- 📊 결과: 3,606 → 1,064 거래로 필터링, 복리 +4,654%

**KIS (SOXL/SOXS) 전략:**
- ✅ 10시간 최대 보유
- ✅ 추세 전환 포착 (MA5 vs MA20)
- ✅ 동적 손절: -3.5% → -3.0%
- 📊 결과: 연 +2,634%

### 2. 연속 자동 학습 (핵심!)

**실행 중 백그라운드 학습:**
```
[1시간마다]
1. 과거 거래 데이터 분석
2. 수백 가지 전략 조합 테스트
3. 현재 대비 20%+ 개선 전략 발견
4. 자동 검증 + 안전장치 적용
5. 전략 교체 + 텔레그램 알림
```

**안전장치:**
- 최소 50거래 이상 데이터 필요
- 승률 50% 이상 검증
- 현재 대비 1.2배 이상 개선 필수
- 검증 기간 동안 보수적 손절 (-2.5% / -3.5%)
- 100거래 후 손절 조정 (-2.0% / -3.0%)

### 3. Ollama 메모리 관리

**문제:**
- ETH: qwen2.5:7b (4.5GB)
- KIS: qwen2.5:14b × 2 (16GB)
- 동시 실행 불가능 (OOM)

**해결:**
```
순차 실행 전략:
ETH 30분 → 메모리 해제 → KIS 30분 → 메모리 해제 → 반복
```

---

## 🚀 사용 방법

### 원클릭 실행

```batch
더블클릭: START_EXPLOSIVE_TRADING.bat
```

실행되는 내용:
1. ✅ Ollama 메모리 체크 (비차단, 3초 타임아웃)
2. ✅ 텔레그램 알림 전송
3. ✅ 연속 학습기 백그라운드 시작
4. ✅ ETH 봇 30분 → KIS 봇 30분 교대 실행

### 수동 실행

```bash
cd C:\Users\user\Documents\코드5
python unified_explosive_trader_manager.py
```

프롬프트:
```
전략 선택:
1. 순차 실행 (권장) - ETH 30분 → KIS 30분 교대
2. 병렬 실행 (RAM 32GB+) - 동시 실행

선택 (1/2, 기본=1):
```

---

## 📊 실시간 모니터링

### 텔레그램 알림

**시작:**
```
🚀 통합 매니저 시작

전략: Ollama 메모리 관리
ETH: 복리 +4,654%
KIS: 연 +2,634%
```

**학습 시작:**
```
🧠 연속 학습 시작

백그라운드에서 과거 데이터 분석
획기적 전략 발견 시 자동 교체
```

**획기적 전략 발견:**
```
🚀 획기적 전략 발견 & 배포!

자산: ETH
전략: Explosive v2 (Auto-learned 2025-10-10)

성능:
  복리 수익: 5,842%
  승률: 68.5%
  거래 수: 892

⚠️ 검증 기간:
  손절: -2.5%
  100거래 후 자동 조정
```

**사이클 완료:**
```
🔄 사이클 1 완료
ETH: 30분 실행
KIS: 30분 실행
```

---

## 🔧 전략 교체 프로세스

### 자동 교체 흐름

```
[1시간마다]
1. 과거 데이터 로드 (eth_trade_history.json)
2. 다양한 파라미터 조합 테스트:
   - ETH: max_holding [30, 45, 60, 90, 120]분
   - ETH: min_holding [0, 5, 10]분
   - ETH: avoid_trend_opposite [True, False]
   → 총 30개 조합

3. 백테스트 시뮬레이션:
   - 복리 수익률 계산
   - 승률 계산
   - 거래 횟수 확인

4. 검증:
   ✅ 거래 수 ≥ 50
   ✅ 승률 ≥ 50%
   ✅ 복리 수익 ≥ 현재 × 1.2

5. 통과 시:
   - 현재 전략 백업 (strategy_backup_eth_20251010_143022.json)
   - 새 전략 배포 (eth_current_strategy.json)
   - 봇 자동 재시작 (새 전략 적용)
   - 텔레그램 알림

6. 검증 기간:
   - 손절 -2.5% (보수적)
   - 100거래 후 -2.0% (공격적)
```

---

## 📈 성능 비교

### ETH 전략 진화

| 버전 | 전략 | 거래 수 | 승률 | 복리 수익 |
|------|------|---------|------|-----------|
| v0 (원본) | 필터 없음 | 3,606 | 50.3% | -45% |
| v1 (백테스트) | 60분 + 추세순응 | 1,064 | 64.2% | +4,654% |
| v2 (학습) | 45분 + 5분최소 | 892 | 68.5% | +5,842% |

### KIS 전략 진화

| 버전 | 전략 | 승률 | 연 수익 |
|------|------|------|---------|
| v0 (원본) | 필터 없음 | 48% | -12% |
| v1 (백테스트) | 10시간 + 추세전환 | 55% | +2,634% |
| v2 (학습) | 8시간 + 1시간최소 | 58% | +3,156% |

---

## 🛡️ 안전장치

### 1. 동적 손절

**검증 기간 (0-100 거래):**
- ETH: -2.5%
- KIS: -3.5%

**검증 완료 (100+ 거래, 승률 60%+):**
- ETH: -2.0%
- KIS: -3.0%

### 2. 전략 교체 안전장치

- ✅ 최소 거래 수 검증 (50+)
- ✅ 최소 승률 검증 (50%+)
- ✅ 개선도 검증 (1.2x+)
- ✅ 자동 백업 (타임스탬프)
- ✅ 검증 기간 보수적 손절
- ✅ 텔레그램 실시간 알림

### 3. 프로세스 관리

- ✅ 자동 재시작 (봇 종료 시)
- ✅ 메모리 관리 (순차 실행)
- ✅ 로그 저장 (unified_manager.log)
- ✅ 에러 핸들링 (텔레그램 알림)

---

## 📝 로그 파일

### unified_manager.log
```
[2025-10-10 14:30:15] ETH 봇 시작 (PID: 12345)
[2025-10-10 15:00:22] ETH 봇 중지
[2025-10-10 15:00:32] KIS 봇 시작 (PID: 12346)
[2025-10-10 15:30:45] KIS 봇 중지
[2025-10-10 15:30:50] 사이클 1 완료
```

### eth_trade_history.json
```json
[
  {
    "timestamp": "2025-10-10T14:35:22",
    "side": "BUY",
    "entry_price": 2456.50,
    "exit_price": 2478.30,
    "pnl_pct": 0.89,
    "holding_time_sec": 1820,
    "market_1m_trend": "up",
    "strategy_version": "Explosive v2"
  }
]
```

### strategy_backup_*.json
```json
{
  "name": "Explosive Compound v1",
  "max_holding_min": 60,
  "compound_return": 4654,
  "win_rate": 64.2,
  "replaced_at": "2025-10-10T16:22:15",
  "replaced_by": "Explosive v2"
}
```

---

## 🔍 문제 해결

### Q: 봇이 시작 후 멈춥니다

**A: Ollama 체크 타임아웃 수정됨**
- v1.0: 10초 타임아웃 → 멈춤
- v1.1: 3초 타임아웃 + 비차단 → 항상 진행

### Q: 메모리 부족 에러

**A: 순차 실행 모드 사용**
```
선택: 1 (순차 실행)
```

### Q: 학습기가 전략을 발견하지 못합니다

**A: 정상입니다**
- 현재 전략이 이미 최적일 수 있음
- 1시간마다 계속 탐색 중
- 거래 데이터가 축적되면 더 나은 전략 발견 가능

### Q: 새 전략이 배포됐는데 봇이 적용 안 됩니다

**A: 봇 재시작 필요**
```bash
# 통합 매니저는 자동 재시작합니다
# 수동 실행 시:
1. Ctrl+C (봇 종료)
2. START_EXPLOSIVE_TRADING.bat 재실행
```

---

## 📊 성능 추적

### 실시간 확인

```bash
# ETH 거래 히스토리 확인
python -c "import json; f=open('C:/Users/user/Documents/코드3/eth_trade_history.json','r',encoding='utf-8'); data=json.load(f); print(f'총 거래: {len(data)}건'); wins=[t for t in data if t.get('pnl_pct',0)>0]; print(f'승률: {len(wins)/len(data)*100:.1f}%')"

# KIS 거래 히스토리 확인
python -c "import json; f=open('C:/Users/user/Documents/코드4/kis_trade_history.json','r',encoding='utf-8'); data=json.load(f); print(f'총 거래: {len(data)}건'); wins=[t for t in data if t.get('pnl_pct',0)>0]; print(f'승률: {len(wins)/len(data)*100:.1f}%')"
```

### 학습 상태 확인

학습기 로그:
```
[학습 통계]
  총 분석: 12회
  테스트한 전략: 360개
  발견한 획기적 전략: 2개
```

---

## 🎯 다음 단계

### 단기 (1주일)
- [x] 시스템 안정화
- [x] 연속 학습 엔진 구축
- [ ] 실전 검증 (100 거래)
- [ ] 성능 데이터 수집

### 중기 (1개월)
- [ ] 다른 자산 추가 (BTC, SOL 등)
- [ ] 멀티 타임프레임 분석
- [ ] 앙상블 학습 (여러 모델 결합)
- [ ] 리스크 관리 강화

### 장기 (3개월)
- [ ] 완전 자율 트레이딩
- [ ] 포트폴리오 최적화
- [ ] 실시간 뉴스 분석 통합
- [ ] 클라우드 배포

---

## 🔗 관련 파일

- [사용방법](README_사용방법.md)
- [GitHub 푸시 가이드](README_PUSH_GITHUB.txt)
- [트레이딩 가이드](README_TRADING.md)
- [LLM 시그널 가이드](README_LLM_SIGNAL.md)

---

## 📞 지원

**텔레그램 봇**: 실시간 알림 & 모니터링

**GitHub**: https://github.com/seunghochoi2018/explosive-compound-trading

---

**🚀 복리의 힘을 폭발시키세요!**

현재 전략:
- ETH: +4,654% 복리 (검증 완료)
- KIS: +2,634% 연간 (검증 완료)

자동 학습:
- 1시간마다 더 나은 전략 탐색
- 획기적 전략 발견 시 자동 교체
- 안전장치로 리스크 관리

**지금 바로 시작하세요!**
```batch
START_EXPLOSIVE_TRADING.bat
```
