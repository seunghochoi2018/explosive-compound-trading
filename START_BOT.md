# SOXL/SOXS LLM 자동매매 봇 시작 가이드

## 현재 상황

### 계좌 잔고 확인 결과
- **계좌번호**: 43113014-01
- **사용자 신고 잔고**: 147,537 KRW (환전 완료)
- **KIS API 응답**: $0.00 또는 HTTP 500 오류

### 원인 분석
KIS API 잔고 조회가 지속적으로 실패하는 이유:

1. **API 권한 문제**: APP_KEY가 잔고/거래 엔드포인트 접근 권한이 없을 수 있음
2. **계좌 설정**: 해외주식 거래 계좌 활성화 필요 (한투 HTS/MTS에서 확인)
3. **정산 대기**: 환전한 USD가 아직 거래 가능 잔고로 반영 안됨
4. **API 타입**: 실전 API vs 모의투자 API 불일치 가능성

### 해결 방법

#### 옵션 1: KIS 설정 확인 (권장)
1. 한국투자증권 HTS/MTS 접속
2. 해외주식 계좌 확인
   - 실제 USD 잔고 확인
   - 해외주식 거래 권한 활성화 여부 확인
3. KIS API 설정 확인
   - [KIS 개발자센터](https://apiportal.koreainvestment.com) 접속
   - APP_KEY 권한 확인 (조회/거래 권한)
   - 실전투자용 vs 모의투자용 확인

#### 옵션 2: 시뮬레이션 모드로 시작 (즉시 가능)
봇은 이미 **시뮬레이션 모드**를 지원합니다:
- 실제 잔고 $0일 때 자동으로 시뮬레이션 전환
- LLM이 가상 거래 데이터로 학습 시작
- 학습 데이터가 쌓이면 정확도 향상
- 실제 잔고 연결 시 즉시 실전 거래 전환 가능

## 봇 실행 방법

### 1. 시뮬레이션 모드 (현재 상태)
```bash
python soxl_soxs_llm_bot.py
```

**특징:**
- ✅ LLM 듀얼 모델 추세 분석 작동
- ✅ 가상 거래로 학습 데이터 축적
- ✅ 승률/패턴 학습 진행
- ❌ 실제 매수/매도 없음

**화면 예시:**
```
[2025-10-06 13:00:00] 시뮬레이션 모드 (잔고: $0)
[2025-10-06 13:00:10] LLM 분석: SOXL 신호 (75% 신뢰도)
[2025-10-06 13:00:10] [가상 매수] SOXL 4주 @ $25.50
[2025-10-06 13:00:40] 가상 수익: +2.5%
```

### 2. 실전 모드 (잔고 연결 후)
잔고 문제 해결 후 동일한 명령어 실행:
```bash
python soxl_soxs_llm_bot.py
```

**자동 감지:**
- USD 잔고 > $100 → 실전 거래 활성화
- LLM 학습 데이터 그대로 유지
- 누적된 승률/패턴 활용

## LLM 학습 시스템

### 듀얼 모델 앙상블
- **모델1 (단기)**: qwen2.5:7b - 1분/5분 타임프레임
- **모델2 (중장기)**: qwen2.5:7b - 5분/15분 타임프레임
- **의사결정**: 두 모델 합의 + 60% 이상 신뢰도

### 학습 데이터
저장 위치: `soxl_soxs_learning_data.json`

```json
{
  "timestamp": "2025-10-06 13:00:00",
  "direction": "SOXL",
  "entry_price": 25.50,
  "exit_price": 26.15,
  "profit": 2.55,
  "result": "WIN"
}
```

### 학습 효과
- 10건 이상: 기본 패턴 인식
- 50건 이상: 승률 패턴 학습
- 100건 이상: 고급 추세 판단

## 전략 파라미터

현재 설정 (`soxl_soxs_llm_bot.py` 수정 가능):
```python
STOP_LOSS = -0.03      # -3% 손절
TAKE_PROFIT = 0.05     # +5% 익절
POSITION_SIZE = 0.20   # 잔고의 20% 투자
CHECK_INTERVAL = 30    # 30초마다 분석
```

## 다음 단계

### 즉시 가능
1. `python soxl_soxs_llm_bot.py` 실행
2. 시뮬레이션 모드로 LLM 학습 시작
3. 학습 데이터 축적 (1시간 = 약 120개 데이터)

### 실전 전환 준비
1. KIS HTS/MTS에서 USD 잔고 확인
2. KIS API 개발자센터에서 권한 확인
3. 필요 시 APP_KEY 재발급 (거래 권한 포함)
4. 잔고 확인 성공 시 자동으로 실전 전환

---

**질문이 있으면 알려주세요!**
